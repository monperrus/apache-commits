[
 {
  "author": "cmpilato", 
  "date": "2005-02-10T04:25:04.745794Z", 
  "msg": [
   "Add --use-pre-commit-hook and --use-post-commit-hook options to", 
   "'svnadmin load'.  And all that that entails...", 
   "This change started out pretty straightforward.  Add some options, rev", 
   "the loader API, badda bing, all done.  But then I started testing, and", 
   "realized that for whatever reason, the libsvn_repos commit code was", 
   "never checking the exitcode from post-commit hooks!!  Befuddled, I set", 
   "about trying to figure out why, but the logs left me without a clear", 
   "answer.  So I flipped the bit that turns on that error-checking, and", 
   "wah-lah -- a whole new set of problems.", 
   "So, it turns out that neither the DAV nor SVN RA layers can deal with", 
   "the situation where a commit succeeds but the post-commit hook fails.", 
   "In the DAV case, there's just no easy way to report that mixed", 
   "success/failure condition -- either the MERGE returns a successful", 
   "error code, or it doesn't.  In the SVN case, I just got lost in a", 
   "super abstract editor (or two?) and basically ran into a limitation of", 
   "my knowledge of that layer.  In other words, I suspect that ra-svn", 
   "*can* support this, but am going to leave that in more able hands.", 
   "So, at the end of it all, I simply taught the three RA layers to treat", 
   "the special error code which represents this post-commit failure", 
   "situation as if there was no error at all.  From the perspective of", 
   "existing client behavior, there's no change at all.  But at least the", 
   "repository commit code (and now the new loader code) behaves as", 
   "advertised.", 
   "* subversion/include/svn_repos.h", 
   "(svn_repos_load_fs2): Was svn_repos_load_fs().  Now accepts", 
   "use_pre_commit_hook and use_post_commit_hook options.", 
   "(svn_repos_load_fs): Deprecated.", 
   "* subversion/libsvn_repos/load.c", 
   "(struct parse_baton): Add use_pre_commit_hook and use_post_commit_hook.", 
   "(close_revision): Run the requested hooks around the commit.", 
   "(svn_repos_load_fs2): Was svn_repos_load_fs().  Now accepts", 
   "use_pre_commit_hook and use_post_commit_hook options, which are", 
   "placed into the parse baton.", 
   "(svn_repos_load_fs): Now just a wrapper around svn_repos_load_fs2().", 
   "* subversion/svnadmin/main.c", 
   "(svnadmin__use_pre_commit_hook, svnadmin__use_post_commit_hook): New.", 
   "(options_table): Add new --use-pre-commit-hook and --use-post-commit-hook", 
   "options.", 
   "(cmd_table): Teach 'load' to accept the new options.", 
   "(struct svnadmin_opt_state): Add use_pre_commit_hook and", 
   "use_post_commit_hook members.", 
   "(subcommand_load): Now call svn_repos_load_fs2().", 
   "(main): Parse the new options.", 
   "* subversion/libsvn_repos/hooks.c", 
   "(run_hook_cmd): Rename 'check_exitcode' to 'read_errstream'.  Now, always", 
   "check the exit code, but maybe don't bother trying to read the error", 
   "stream.", 
   "* subversion/mod_dav_svn/version.c", 
   "(dav_svn_merge): Ignore SVN_ERR_REPOS_POST_COMMIT_HOOK_FAILED.", 
   "* subversion/libsvn_repos/commit.c", 
   "(close_edit): Ignore SVN_ERR_REPOS_POST_COMMIT_HOOK_FAILED."
  ], 
  "revision_id": "853035"
 }, 
 {
  "author": "julianfoad", 
  "date": "2005-02-10T03:28:13.723098Z", 
  "msg": [
   "Issue #1310: Clear iteration pools at the beginning of each iteration rather", 
   "than the end, and destroy them afterwards, as per our policy.", 
   "Based on a patch from Michael Price.", 
   "* subversion/clients/cmdline/add-cmd.c (svn_cl__add)", 
   "* subversion/clients/cmdline/checkout-cmd.c (svn_cl__checkout)", 
   "* subversion/clients/cmdline/cleanup-cmd.c (svn_cl__cleanup)", 
   "* subversion/clients/cmdline/resolved-cmd.c (svn_cl__resolved)", 
   "* subversion/clients/cmdline/status-cmd.c (svn_cl__status)", 
   "* subversion/clients/cmdline/switch-cmd.c (rewrite_urls)", 
   "* subversion/libsvn_client/commit_util.c (harvest_committables,", 
   "svn_client__harvest_committables, svn_client__do_commit)", 
   "* subversion/libsvn_client/revert.c (svn_client_revert)", 
   "* subversion/libsvn_delta/text_delta.c (svn_txdelta_send_txstream)", 
   "* subversion/libsvn_fs_base/bdb/changes-table.c (svn_fs_bdb__changes_fetch)", 
   "* subversion/libsvn_fs_base/reps-strings.c (svn_fs_base__rep_deltify)", 
   "* subversion/libsvn_fs_base/tree.c (deltify_mutable)", 
   "* subversion/libsvn_ra_dav/props.c (svn_ra_dav__do_proppatch)", 
   "* subversion/libsvn_ra_local/ra_plugin.c (svn_ra_local__get_dir)", 
   "* subversion/libsvn_repos/delta.c (delta_dirs)", 
   "* subversion/libsvn_repos/dump.c (close_directory, svn_repos_dump_fs2)", 
   "* subversion/libsvn_repos/log.c (svn_repos_get_logs3)", 
   "* subversion/libsvn_subr/io.c (svn_io_dir_walk)", 
   "* subversion/libsvn_wc/adm_ops.c (svn_wc_process_committed, mark_tree,", 
   "svn_wc_revert, svn_wc_remove_from_revision_control)", 
   "* subversion/libsvn_wc/entries.c (svn_wc__entries_write)", 
   "* subversion/libsvn_wc/log.c (svn_wc__run_log)", 
   "* subversion/libsvn_wc/update_editor.c (complete_directory)", 
   "* subversion/mod_dav_svn/liveprops.c (dav_svn_insert_all_liveprops)", 
   "* subversion/mod_dav_svn/repos.c (dav_svn_deliver)", 
   "* subversion/svnadmin/main.c (subcommand_rmtxns)", 
   "* subversion/svnlook/main.c (print_tree)", 
   "* subversion/svnserve/serve.c (get_dir)"
  ], 
  "revision_id": "853034"
 }, 
 {
  "author": "lundblad", 
  "date": "2005-02-09T21:48:47.716675Z", 
  "msg": [
   "Locking branch: Fix get-locks in svnserve.", 
   "* subversion/svnserve/serve.c (get_locks): Add missing parentheses to response."
  ], 
  "revision_id": "853033"
 }, 
 {
  "author": "sussman", 
  "date": "2005-02-09T21:25:48.614602Z", 
  "msg": [
   "Locking branch:  make the new svn_ra_get_locks() dav REPORT actually work.", 
   "* subversion/mod_dav_svn/version.c", 
   "(dav_svn__get_locks_report):  fix XML typos, and always send 'owner' field.", 
   "* subversion/libsvn_ra_dav/fetch.c", 
   "(svn_ra_dav__get_locks):   be sure to initialize all baton fields.", 
   "* tools/examples/getlocks_test.c:", 
   "new example program that tests svn_ra_get_locks()."
  ], 
  "revision_id": "853032"
 }, 
 {
  "author": "sussman", 
  "date": "2005-02-09T20:48:37.888085Z", 
  "msg": [
   "Locking branch:  fix brain-o in new repos wrapper.", 
   "* subversion/libsvn_repos/fs-wrap.c", 
   "(svn_repos_fs_get_locks):  check that authz_read_func exists before using it."
  ], 
  "revision_id": "853031"
 }
]