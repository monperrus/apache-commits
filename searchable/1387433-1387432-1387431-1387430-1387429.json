[
 {
  "author": "mbautin", 
  "date": "2012-09-19T01:52:58.383254Z", 
  "msg": [
   "[jira] [HBASE-6808] [89-fb] Add the ability to query region flush time and current time to regionserver Thrift API", 
   "Author: mbautin", 
   "Summary: In order to do reliable bulk load with WAL turned off through the C++ API we need to be able to query last flush times for all regions on a regionserver as well as the current time on the server. By only comparing timestamps that come from the same regionserver we avoid being affected by clock skew.", 
   "Test Plan:", 
   "Unit tests.", 
   "Test through the C++ HBase client.", 
   "Reviewers: aaiyer, kranganathan", 
   "Reviewed By: aaiyer", 
   "Differential Revision: https://reviews.facebook.net/D5517"
  ], 
  "revision_id": "1387433"
 }, 
 {
  "author": "mbautin", 
  "date": "2012-09-19T01:52:34.537908Z", 
  "msg": [
   "[master] Fix gen_thrift_code.sh to stop generating IOError.java.new", 
   "Author: mbautin"
  ], 
  "revision_id": "1387432"
 }, 
 {
  "author": "kgiusti", 
  "date": "2012-09-19T01:52:21.944890Z", 
  "msg": [
   "Fix ssl_stub"
  ], 
  "revision_id": "1387431"
 }, 
 {
  "author": "mbautin", 
  "date": "2012-09-19T01:52:10.673362Z", 
  "msg": [
   "[HBASE-6813] [0.89-fb] Optmise the time we hold the updateLock during Log Roll", 
   "Author: aaiyer", 
   "Summary:", 
   "Titan appserver sees a lot of timeouts/errors on cell 22 and cell 4.", 
   "One thing that came out of the investigation is that (a) most of the", 
   "operationTooSlow was multiPuts, and (b) these seem to be correlated", 
   "around Log rolls.", 
   "It appears that when a log roll is happening, the log roller grabs the", 
   "updateLock, and no put/multiPut can write to WAL at that time. A lot", 
   "of I/O seem to be done under the lock, some of which can be done", 
   "outside.", 
   "Specifically,", 
   "(i) Create the new Log file, before we grab the lock.", 
   "(ii) sync under the lock. But allow the close to be done later.", 
   "This is because closing a HDFS file will require the NN to receive", 
   "a blockReport from at least one of the DN. We do not want to block", 
   "for this, while holding the updatesLock.", 
   "(iii) Write/Sync a dummy entry to the new Log, before we try to \"roll\" it", 
   "in. This is done because the first write involves a call to NN for", 
   "addBlock, and to set up the appropriate HDFS pipeline. The first sync needs", 
   "to wait until the NN writes its state to disk (since the modifications at", 
   "add block were only kept in memory). By writing a dummy entry, we", 
   "ensure that \"real\" appends, that come later, do not have to go through this", 
   "costly process.", 
   "Test Plan:", 
   "Essentially a performance optimisation. Will run all MR unit test -- for safety.", 
   "Will check the performance after deployment to the DL.", 
   "On the dev cluster, msgstore209: this looks really promising", 
   "about 2 orders of magnitude improvement.", 
   "on msgstore269.sn4:", 
   "2012-09-17 11:37:33,924 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 502 ms.", 
   "2012-09-17 11:37:50,141 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 415 ms.", 
   "2012-09-17 11:38:05,498 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 510 ms.", 
   "2012-09-17 11:38:20,087 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 560 ms.", 
   "2012-09-17 11:38:33,739 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 521 ms.", 
   "2012-09-17 11:38:47,537 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 585 ms.", 
   "2012-09-17 11:39:05,388 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 425 ms.", 
   "2012-09-17 11:39:20,890 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 653 ms.", 
   "2012-09-17 11:39:37,152 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 442 ms.", 
   "2012-09-17 12:02:55,975 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 132 ms.", 
   "2012-09-17 12:03:50,573 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 664 ms.", 
   "2012-09-17 12:04:06,833 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 582 ms.", 
   "2012-09-17 12:04:25,330 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 695 ms.", 
   "2012-09-17 12:10:15,282 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 161 ms.", 
   "2012-09-17 12:10:29,485 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 497 ms.", 
   "2012-09-17 12:10:45,153 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 564 ms.", 
   "2012-09-17 12:11:02,016 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 460 ms.", 
   "2012-09-17 12:18:06,894 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 142 ms.", 
   "2012-09-17 12:19:01,013 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 618 ms.", 
   "2012-09-17 12:19:15,486 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 582 ms.", 
   "2012-09-17 12:19:29,246 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 495 ms.", 
   "2012-09-17 12:22:00,707 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 294 ms.", 
   "2012-09-17 12:24:17,927 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 141 ms.", 
   "2012-09-17 12:25:11,850 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 777 ms.", 
   "2012-09-17 12:25:26,177 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 687 ms.", 
   "2012-09-17 12:25:38,496 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 645 ms.", 
   "2012-09-17 12:25:56,679 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 435 ms.", 
   "2012-09-17 12:28:27,963 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:29:25,607 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:29:42,078 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 16 ms.", 
   "2012-09-17 12:29:56,325 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 17 ms.", 
   "2012-09-17 12:33:55,944 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:34:13,230 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 22 ms.", 
   "2012-09-17 12:34:34,981 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 1 ms.", 
   "2012-09-17 12:34:51,631 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:35:08,717 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 6 ms.", 
   "2012-09-17 12:35:21,406 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 5 ms.", 
   "2012-09-17 12:35:34,232 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:35:49,090 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:36:03,452 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:36:17,868 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:36:33,197 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 6 ms.", 
   "2012-09-17 12:36:51,197 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 390 ms.", 
   "2012-09-17 12:37:03,352 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 5 ms.", 
   "2012-09-17 12:37:16,447 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:37:31,997 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "on msgstore289.snc4:", 
   "2012-09-17 11:38:21,966 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 412 ms.", 
   "2012-09-17 11:38:42,371 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 581 ms.", 
   "2012-09-17 11:38:57,865 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 560 ms.", 
   "2012-09-17 11:39:11,573 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 501 ms.", 
   "2012-09-17 11:39:25,504 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 487 ms.", 
   "2012-09-17 11:39:42,216 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 448 ms.", 
   "2012-09-17 12:02:55,938 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 133 ms.", 
   "2012-09-17 12:03:50,524 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 622 ms.", 
   "2012-09-17 12:04:04,616 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 566 ms.", 
   "2012-09-17 12:04:16,900 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 523 ms.", 
   "2012-09-17 12:04:34,805 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 419 ms.", 
   "2012-09-17 12:10:29,172 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 432 ms.", 
   "2012-09-17 12:10:45,001 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 444 ms.", 
   "2012-09-17 12:10:59,241 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 443 ms.", 
   "2012-09-17 12:18:07,314 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 132 ms.", 
   "2012-09-17 12:19:03,560 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 531 ms.", 
   "2012-09-17 12:19:20,536 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 499 ms.", 
   "2012-09-17 12:19:37,737 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 450 ms.", 
   "2012-09-17 12:22:08,662 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 329 ms.", 
   "2012-09-17 12:24:17,868 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 140 ms.", 
   "2012-09-17 12:25:11,547 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 517 ms.", 
   "2012-09-17 12:25:28,635 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 395 ms.", 
   "2012-09-17 12:25:46,021 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 540 ms.", 
   "2012-09-17 12:28:27,954 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:29:23,291 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:29:38,049 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 5 ms.", 
   "2012-09-17 12:29:49,822 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 6 ms.", 
   "2012-09-17 12:33:51,669 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:34:06,871 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:34:29,074 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:34:42,253 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 7 ms.", 
   "2012-09-17 12:34:55,319 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:35:11,577 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:35:27,700 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:35:39,159 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:35:56,510 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:36:09,439 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:36:25,609 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:36:38,043 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:36:52,594 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "^N2012-09-17 12:37:11,480 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:37:26,547 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:37:42,288 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 1 ms.", 
   "msgstore249:", 
   "2012-09-17 11:38:20,865 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 395 ms.", 
   "2012-09-17 11:38:33,491 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 184 ms.", 
   "2012-09-17 11:38:49,294 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 100 ms.", 
   "2012-09-17 11:39:02,444 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 498 ms.", 
   "2012-09-17 11:39:18,797 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 533 ms.", 
   "2012-09-17 11:39:33,345 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 473 ms.", 
   "2012-09-17 12:02:55,924 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 138 ms.", 
   "2012-09-17 12:03:52,781 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 675 ms.", 
   "2012-09-17 12:04:09,109 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 535 ms.", 
   "2012-09-17 12:04:24,060 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 510 ms.", 
   "2012-09-17 12:10:18,085 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 318 ms.", 
   "2012-09-17 12:10:31,945 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 422 ms.", 
   "2012-09-17 12:10:46,144 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 595 ms.", 
   "2012-09-17 12:11:02,067 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 588 ms.", 
   "2012-09-17 12:18:06,716 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 141 ms.", 
   "2012-09-17 12:19:00,312 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 411 ms.", 
   "2012-09-17 12:19:17,512 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 390 ms.", 
   "2012-09-17 12:19:38,872 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 716 ms.", 
   "2012-09-17 12:22:05,979 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 397 ms.", 
   "2012-09-17 12:24:17,039 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 141 ms.", 
   "2012-09-17 12:25:13,046 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 507 ms.", 
   "2012-09-17 12:25:29,480 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 428 ms.", 
   "2012-09-17 12:25:44,468 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: Blocked updates for 488 ms.", 
   "2012-09-17 12:28:26,604 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:29:20,893 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:29:38,118 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:29:55,748 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:33:51,870 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:34:10,603 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:34:33,645 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:34:49,720 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 7 ms.", 
   "2012-09-17 12:35:05,421 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:35:23,116 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:35:41,707 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:35:55,909 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 14 ms.", 
   "2012-09-17 12:36:10,984 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:36:26,346 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:36:44,326 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 1 ms.", 
   "2012-09-17 12:36:59,502 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:37:15,892 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:37:28,174 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "2012-09-17 12:37:44,640 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLog: (optimised) Blocked updates for 0 ms.", 
   "Reviewers: kannan, hkuang, liyintang", 
   "Reviewed By: liyintang", 
   "CC: hbase-eng@, nspiegelberg, mycnyc, amirshim, kranganathan, liyintang", 
   "Differential Revision: https://phabricator.fb.com/D575297", 
   "Task ID: 1734024"
  ], 
  "revision_id": "1387430"
 }, 
 {
  "author": "mbautin", 
  "date": "2012-09-19T01:51:45.993203Z", 
  "msg": [
   "[HBASE-6059] Fixing WAL Replay bug", 
   "Author: lipi"
  ], 
  "revision_id": "1387429"
 }
]