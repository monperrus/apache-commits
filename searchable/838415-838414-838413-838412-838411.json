[
 {
  "author": "brane", 
  "date": "2001-01-28T15:50:36.000000Z", 
  "msg": [
   "* txn-table.c (svn_fs__get_txn_list): Copy the transaction", 
   "ID to the right pool, and to make sure it's null-terminated."
  ], 
  "revision_id": "838415"
 }, 
 {
  "author": "ghudson", 
  "date": "2001-01-27T05:46:04.000000Z", 
  "msg": [
   "We can do the rest of the tests now."
  ], 
  "revision_id": "838414"
 }, 
 {
  "author": "ghudson", 
  "date": "2001-01-27T05:43:30.000000Z", 
  "msg": [
   "Redo Karl's change to this file.  Instead of ref-counting directory", 
   "batons, keep a count of open files in edit_context.  Open issue: as", 
   "with Karl's approach, svn_delta_get_xml_editor generates some output", 
   "before the first editor call; I'm not sure I consider that within the", 
   "contract.", 
   "Relative to rev 1.24:", 
   "(replace_root): Removed.", 
   "(close_edit): No longer an editor function; accepts a struct", 
   "edit_context * instead of a void *.", 
   "(edit_context): Replaces edit_baton.  All references changed.", 
   "Add open_file_count and root_dir_closed fields to track when the edit", 
   "is over.", 
   "(close_directory): Note when the root dir is closed, and close the", 
   "edit if there are no open files at that point.", 
   "(add_file, replace_file): Bump open_file_count.", 
   "(close_file): Decrement open_file_count, and close the edit if the", 
   "root dir has been closed and there are no open files.", 
   "(tree_editor): Remove entries for replace_root and close_edit.", 
   "(svn_delta_get_xml_editor, close_edit): Don't use a subpool for the", 
   "editor.  We still use subpools for the directory and file batons", 
   "because they use a large, unbounded amount of storage together, but", 
   "there's no need for a subpool for the editor itself.", 
   "(svn_delta_get_xml_editor): Conform to new interface."
  ], 
  "revision_id": "838413"
 }, 
 {
  "author": "", 
  "date": "2001-01-27T02:36:36.000000Z", 
  "msg": [
   "This commit was manufactured by cvs2svn to create tag 'post-edit-baton-", 
   "removal'."
  ], 
  "revision_id": "838412"
 }, 
 {
  "author": "kfogel", 
  "date": "2001-01-27T02:36:35.000000Z", 
  "msg": [
   "This is Change #1, from the set of 8 or so changes posted by Ben to", 
   "the dev list and now recorded in the STACK file.  Prior to this", 
   "commit, the tree was tagged with `pre-edit-baton-removal'.", 
   "When an editor is created, the root_dir_baton is returned and used as", 
   "the baton for the first call requiring a dir baton.  There is no more", 
   "externally visible edit_baton, and the editor functions replace_root()", 
   "and close_edit() are gone.  This resolves the ambiguity about whether", 
   "replace_root() can be called multiple times per edit, or only once.", 
   "Since you now get a root directory baton when you start the edit,", 
   "clearly you can call replace_directory() on it only once.", 
   "As a result of this change, the editor in libsvn_delta/xml_output.c", 
   "has become a reference counting editor, so it can continue to handle", 
   "postfix text-deltas.  Wheras formerly its close_edit() took care of", 
   "closing the delta-pkg, now close_directory() has to close the", 
   "outermost tree-delta, while leaving the closing of the delta-pkg for", 
   "free_dir_baton(), which will only get run after the last postfix text", 
   "delta is sent and the top dir baton's reference count reaches zero.", 
   "Or that's the idea, anyway.  Unfortunately, I seem to have broken the", 
   "xml output editor, and after spending a few hours trying to make it", 
   "work under the new scheme, I'm ready for Greg Hudson to have a swing", 
   "at it.  I'm pretty sure there's nothing theoretically wrong with doing", 
   "things in the ref counting way, but am just not familiar enough with", 
   "the code, particularly get_to_elem(), to know what I'm doing wrong.", 
   "In the meantime, I've commented out various tests, so `make check'", 
   "will still work for sufficiently small values of \"work\".  (Actually, I", 
   "think the fs tests are failing for some reason, but that's not related", 
   "to this commit.)  Greg, to reproduce the xml problems, uncomment the", 
   "\"exit 0\" in client/tests/svn-test.sh and watch svn try to update a", 
   "working copy from a malformed commit-2.xml.", 
   "* libsvn_delta/xml_output.c (replace_root, close_edit): Removed.", 
   "(edit_context): Replaces edit_baton.", 
   "(tree_editor): Remove entries for replace_root and close_edit.", 
   "(svn_delta_get_xml_editor): Replace edit_baton with root_dir_baton.", 
   "(everywhere): Replace edit_baton with edit_context.", 
   "(file_baton): Added new parent_dir_baton field.", 
   "(dir_baton): Same new parent_dir_baton, ref_count fields.", 
   "(make_file_baton): Take parent_dir_baton, bump its ref_count.", 
   "(make_dir_baton): Same as above, plus initialize own ref_count.", 
   "(decrement_ref_count, free_dir_baton): New funcs, former invokes", 
   "latter when dir baton's ref_count reaches zero.  Latter handles root", 
   "directory specially.", 
   "(close_file, close_directory): Decrement ref_counts appropriately.", 
   "* include/svn_delta.h (svn_delta_edit_fns_t): Remove replace_root", 
   "and close_edit, change documentation accordingly.", 
   "(svn_delta_compose_editors, svn_delta_wrap_editor,", 
   "svn_delta_get_xml_editor, svn_delta_make_xml_parser,", 
   "svn_delta_xml_auto_parse): Replace edit_baton parameters with", 
   "root_dir_baton parameters.", 
   "* include/svn_fs.h (svn_fs_dir_delta): Replace edit_baton parameter", 
   "with root_dir_baton parameter.", 
   "* include/svn_wc.h (svn_wc_get_checkout_editor,", 
   "svn_wc_get_update_editor, svn_wc_crawl_local_mods,", 
   "svn_wc_crawl_revisions): Replace edit_baton parameter with", 
   "root_dir_baton parameter.", 
   "* include/svn_ra.h (svn_ra_plugin_t): Replace edit_baton parameter with", 
   "root_dir_baton parameter in get_commit_editor and do_checkout.  In", 
   "do_update, do the same for report_baton and update_baton, which are", 
   "also edit_batons anyway.  Report editors in general are probably", 
   "obsolete and about to be replaced with something simpler.", 
   "* include/svn_client.h (svn_client_checkout, svn_client_update,", 
   "svn_client_commit): Replace edit_baton parameter with root_dir_baton", 
   "parameter.", 
   "* include/svn_test.h (svn_test_get_editor): Replace edit_baton", 
   "parameter with root_dir_baton parameter.", 
   "* client/trace-update.c, client/trace-commit.c (edit_context): New", 
   "struct type, replaces edit_baton.", 
   "(dir_baton): Store an edit_context now, not an edit_baton.", 
   "(replace_root, close_edit): Removed.", 
   "(trace_editor): Remove replace_root and close_edit.", 
   "(svn_cl__get_trace_commit_editor, svn_cl__get_trace_update_editor):", 
   "return a root_dir_baton.  Construct it to contain an edit_context.", 
   "* libsvn_delta/delta.h (svn_xml__digger_t): Remove edit_baton.", 
   "Replace rootdir_baton with root_dir_baton, for consistency.", 
   "* libsvn_delta/tests/deltaparse-test.c (main): Replace edit_baton with", 
   "root_dir_baton.", 
   "* libsvn_delta/tests/xml-output-test.c (main): Replace edit_baton with", 
   "root_dir_baton, get rid of now-superfluous root_baton.  Remove calls", 
   "to replace_root and close_edit.", 
   "* libsvn_delta/xml_parse.c (svn_delta_make_xml_parser,", 
   "svn_delta_xml_auto_parse): Replace edit_baton with root_dir_baton.", 
   "(xml_handle_start): Remove call to replace_root.  Also remove setting", 
   "of initial frame's baton, which we take care of in do_stack_append", 
   "now.", 
   "(do_stack_append): Set baton of initial stack frame to", 
   "root_dir_baton.", 
   "(svn_delta_xml_parsebytes): Don't call close_edit.", 
   "* libsvn_delta/compose_editors.c (edit_baton): Removed.", 
   "(dir_baton): Get the fields edit_baton used to have.", 
   "(add_directory, replace_directory): Put new stuff into child dir batons.", 
   "* libsvn_delta/delta.c (svn_fs_dir_delta): Take root_dir_baton instead", 
   "of edit_baton.  Don't call replace_root.", 
   "* client/cl.h (svn_cl__get_trace_update_editor,", 
   "svn_cl__get_trace_commit_editor): Take root_dir_baton not edit_baton.", 
   "* client/checkout-cmd.c (svn_cl__checkout): Use root_dir_baton", 
   "instead of edit_baton with the trace editor.", 
   "* client/commit-cmd.c (svn_cl__commit): Use root_dir_baton", 
   "instead of edit_baton with the trace editor.", 
   "* client/update-cmd.c (svn_cl__update): Use root_dir_baton", 
   "instead of edit_baton with the trace editor.", 
   "* libsvn_client/update.c (svn_client_update): Use root_dir_baton", 
   "instead of edit_baton with the update editors.", 
   "* libsvn_client/checkout.c (svn_client_checkout): Use root_dir_baton", 
   "instead of edit_baton with the checkout editors.", 
   "* libsvn_client/commit.c (svn_client_commit): Use root_dir_baton", 
   "instead of edit_baton with the commit editors.", 
   "* libsvn_client/client.h, libsvn_client/apply_edits.c (apply_delta,", 
   "do_edits, svn_client__checkout_internal, svn_client__update_internal):", 
   "Use root_dir_batons instead of edit_batons with all editors.", 
   "* libsvn_ra_da/tests/ra-dav-test.c (main): Use root_dir_baton instead", 
   "of edit_baton.  Don't call close_edit.", 
   "* libsvn_ra_dav/ra-commit.c (main): Use root_dir_baton instead of", 
   "edit_baton.", 
   "* libsvn_ra_dav/commit.c (commit_replace_root): Removed.", 
   "(commit_close_edit): Removed.", 
   "(dir_baton_t): New field `is_root'.", 
   "(svn_ra_dav__get_commit_editor): Replace edit_baton parameter with", 
   "root_dir_baton parameter.  Initialize root_dir_baton using code from", 
   "replace_root(), setting new `is_root' field.", 
   "(commit_close_dir): If this is the root dir baton, do what close_edit", 
   "used to do.", 
   "* libsvn_ra_dav/fetch.c (fetch_ctx_t): Replace edit_baton field with", 
   "root_dir_baton.", 
   "(svn_ra_dav__checkout): Fold edit_baton and root_baton into a single", 
   "root_dir_baton.", 
   "(svn_ra_dav__get_update_editor): Replace edit_baton with", 
   "root_dir_baton, even though this function is #if'd out right now", 
   "anyway.", 
   "(update_editor): Remove the null placeholders where", 
   "update_replace_root and update_close_edit would have been.  How", 
   "interestingly coincidental that those were the only two not", 
   "implemented here!", 
   "* libsvn_ra_dav/ra_dav.h (svn_ra_dav__get_commit_editor,", 
   "svn_ra_dav__checkout): Replace edit_baton with root_dir_baton.", 
   "* libsvn_wc/tests/checkout-test.c (apply_delta): Use root_dir_baton", 
   "instead of edit_baton.", 
   "* libsvn_wc/tests/commit-test.c (main): Use root_dir_baton instead of", 
   "edit_baton.", 
   "* libsvn_wc/adm_crawler.c (svn_wc_crawl_local_mods): Replace", 
   "edit_baton with root_dir_baton.  Replace close_edit call with a call", 
   "to close_directory on that root_dir_baton.", 
   "(svn_wc_crawl_revisions): Don't call close_edit.", 
   "(do_dir_replaces): Use root_dir_baton instead of edit_baton.  Don't", 
   "call replace_root, just use the baton we have.", 
   "(report_local_mods): Use root_dir_baton instead of edit_baton.", 
   "* libsvn_wc/get_editor.c (make_editor): Replace edit_baton with", 
   "root_baton, set up an edit_context instead.  Do what replace_root used", 
   "to do.", 
   "(free_dir_baton): Do what close_edit used to do, if this is the root", 
   "directory baton.", 
   "(edit_context): Replaces edit_baton, still lives in dir_baton.", 
   "(replace_root): Removed.", 
   "(close_edit): Removed.", 
   "(replace_root): Removed.", 
   "(tree_editor): Removed replace_root and close_edit members.", 
   "(svn_wc_get_update_editor, svn_wc_get_checkout_editor): Use", 
   "root_dir_baton instead of edit_baton.", 
   "* libsvn_wc/tests-common/svn_test_editor.c (edit_context): Replaces", 
   "edit_baton.", 
   "(test_replace_root, test_close_edit): Removed.", 
   "(svn_test_get_editor): Do what test_replace_root used to do.", 
   "Don't put test_replace_root and test_close_edit in the editor", 
   "anymore.", 
   "(close_directory): When called on the root directory baton, do what", 
   "test_close_edit used to do.", 
   "Unrelated changes:", 
   "* libsvn_delta/xml_parse.c (xml_handle_start): Fix typo.", 
   "* libsvn_delta/compose_editors.c (add_directory, replace_directory):", 
   "Set child_baton's parent to parent_baton instead of NULL.  Why was it", 
   "being set to NULL before, anyway?", 
   "* libsvn_wc/adm_ops.c (svn_wc_get_pristine_copy_path): Don't bother", 
   "declaring unused err variable."
  ], 
  "revision_id": "838411"
 }
]